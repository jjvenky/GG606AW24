<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>GG606 Winter 2024 - 3&nbsp; Assignments</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./readings.html" rel="prev">
<link href="./favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./assignments.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Assignments</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">GG606 Winter 2024</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Main</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./readings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Readings</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignments.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Assignments</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#assignment-1---importing-parsing-and-querying-data-in-the-wild" id="toc-assignment-1---importing-parsing-and-querying-data-in-the-wild" class="nav-link active" data-scroll-target="#assignment-1---importing-parsing-and-querying-data-in-the-wild"><span class="header-section-number">3.1</span> Assignment 1 - Importing, parsing, and querying data in the wild</a></li>
  <li><a href="#assignment-2---real-world-data-wrangling" id="toc-assignment-2---real-world-data-wrangling" class="nav-link" data-scroll-target="#assignment-2---real-world-data-wrangling"><span class="header-section-number">3.2</span> Assignment 2 - Real world data wrangling</a></li>
  <li><a href="#analytics-demo" id="toc-analytics-demo" class="nav-link" data-scroll-target="#analytics-demo"><span class="header-section-number">3.3</span> Analytics Demo</a></li>
  <li><a href="#lecture-engagement" id="toc-lecture-engagement" class="nav-link" data-scroll-target="#lecture-engagement"><span class="header-section-number">3.4</span> Lecture engagement</a>
  <ul class="collapse">
  <li><a href="#questions-for-the-palmerpenguins" id="toc-questions-for-the-palmerpenguins" class="nav-link" data-scroll-target="#questions-for-the-palmerpenguins"><span class="header-section-number">3.4.1</span> Questions for the palmerpenguins:</a></li>
  <li><a href="#questions-for-the-water-isotopes" id="toc-questions-for-the-water-isotopes" class="nav-link" data-scroll-target="#questions-for-the-water-isotopes"><span class="header-section-number">3.4.2</span> Questions for the water isotopes:</a></li>
  </ul></li>
  <li><a href="#participation" id="toc-participation" class="nav-link" data-scroll-target="#participation"><span class="header-section-number">3.5</span> Participation</a></li>
  <li><a href="#course-notebook" id="toc-course-notebook" class="nav-link" data-scroll-target="#course-notebook"><span class="header-section-number">3.6</span> Course Notebook</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Assignments</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="assignment-1---importing-parsing-and-querying-data-in-the-wild" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="assignment-1---importing-parsing-and-querying-data-in-the-wild"><span class="header-section-number">3.1</span> Assignment 1 - Importing, parsing, and querying data in the wild</h2>
<p>The National Earthquake Information Center (NEIC) determines the location and size of all significant earthquakes that occur worldwide and disseminates this information immediately to national and international agencies, scientists, critical facilities, and the general public. The NEIC compiles and provides to scientists and to the public an extensive seismic database that serves as a foundation for scientific research through the operation of modern digital national and global seismograph networks and cooperative international agreements.</p>
<p>This <a href="data/earthquakes_5.5_1960-2023.csv">dataset</a> includes a record of the date, time, location, depth, magnitude, and source of every earthquake with a reported magnitude 2.5 or greater since 1965. Since the API for the NEIC database only allows 20,000 data points to be downloaded at once, I have provided a dataset from 1960 to 2023 for earthquakes of magnitude 5.5 or greater. Please consult <a href="https://earthquake.usgs.gov/earthquakes/search/" class="uri">https://earthquake.usgs.gov/earthquakes/search/</a> to see how the data can be delivered and for the documentation.</p>
<p>You can use this <a href="GG606_assignment_1_sample.Rmd">Rmd file</a> or this <a href="GG606_assignment_1_sample.qmd">qmd file</a> as a template. Rstudio (now posit) has some easy to follow lessons on rmarkdown <a href="https://rstudio.github.io/cheatsheets/html/rmarkdown.html" class="uri">https://rstudio.github.io/cheatsheets/html/rmarkdown.html</a> and quarto <a href="https://rstudio.github.io/cheatsheets/html/quarto.html" class="uri">https://rstudio.github.io/cheatsheets/html/quarto.html</a> . We will briefly discuss rmarkdown and quarto in class.</p>
<p>Your assignment should answer the following questions and be as reproducible as you can make it (i.e., I should be able to reproduce your answers). This means that you must read data in from a URL so that I can replicate your work, do not include any external data files in your submission, only submit one Rmd or qmd file. You can use external data to supplement your analyses if you want to. For each answer provide a short write up explaining the approach you took to the question. There are not necessarily correct answers, and I expect your answers to vary from classmates, however you should be able to provide a clear illustration via your code of how you arrived at the conclusion you did.</p>
<p>Questions:</p>
<ul>
<li><p>Read the data in and clean it for analysis, using the readr package functions for reading and parsing data. Provide a few comments on the types of earthquakes and the sources of information of the earthquakes. [5 marks]</p></li>
<li><p>Did more earthquakes happen on weekends or weekdays? Include a figure [5 marks]</p></li>
<li><p>Has there been any change in the frequency of earthquakes? Include a figure [5 marks]</p></li>
<li><p>Where were there more earthquakes in the 1990s, South America or North America? Include a figure [5 marks]</p></li>
<li><p>Comment on changes in the data with time: a) earthquakes per year, b) type of earthquakes, and c) magnitude resolution. Include a figure [5 marks]</p></li>
<li><p>Comment on how lessons from Wilke’s <a href="https://clauswilke.com/dataviz/">Fundamentals of Data Visualization</a> were applied to each figure with specific reference to book sections [5 marks]</p></li>
</ul>
</section>
<section id="assignment-2---real-world-data-wrangling" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="assignment-2---real-world-data-wrangling"><span class="header-section-number">3.2</span> Assignment 2 - Real world data wrangling</h2>
<p>The Canadian Census from 2021 has mostly be released and made available to the public. You will analyze Canadian census data for this assignment. However, the real goal of this assignment is to get you familiar with the process of learning a new R package. More than anything, the R landscape of packages is quickly changing and being able to learn about, understand, and use new packages is a vital skill for scientific data wrangling. Often, new published papers will have related R packages and may or may not have clear documentation or vignettes (which are best for getting up and running). Evaluating an R package requires quickly ascertaining whether a package can do what you need it to, how to format data for it, what outputs are generated, and what parameters need to be set/configured. There is very little standardization across R packages (outside of the tidyverse) so this step of evaluation can take some time..</p>
<p>Your goal for this assignment is to get up and running with the cancensus package. You can learn more about the cancensus package here: <a href="https://mountainmath.github.io/cancensus/index.html" class="uri">https://mountainmath.github.io/cancensus/index.html</a></p>
<p>To submit for this assignment: a reproducible rmarkdown or quarto file that develops an analysis of census data for a geographical location in Canada of interest to you. You are free to incorporate external data from other sources if you wish, but the focus should be on data that are in the census. The geography of interest must meet the following criteria:</p>
<ul>
<li><p>has a name that starts with same letter as your first name or last name;</p></li>
<li><p>is comprised of at least 30 geographic units; and</p></li>
<li><p>is somewhere that you have not personally visited; and</p></li>
<li><p>involves at least three census dates.</p></li>
</ul>
<p>The analysis may focus on traditional census themes like population change or dive deep into more specific demographic or regional questions. Your analysis should present a coherent data story, and should mix visualizations and written interpretations of your analysis. You must include all R code for reproducing your report, however do not have to show all of the code in the output in the final report (i.e.&nbsp;you can have <code>echo=FALSE</code> in some of your code chunks if you want them hidden from the output - learn how to use chunk options in RStudio <a href="https://rmarkdown.rstudio.com/lesson-3.html" class="uri">https://rmarkdown.rstudio.com/lesson-3.html</a> or <a href="https://quarto.org/docs/get-started/computations/rstudio.html" class="uri">https://quarto.org/docs/get-started/computations/rstudio.html</a> ). Focus on quality over quantity, only include analysis which contributes to your overall narrative, do not include every type of graph or model you explored.</p>
<p>Marks will be reserved for detailed comment on how lessons from Wilke’s <a href="https://clauswilke.com/dataviz/">Fundamentals of Data Visualization</a> were applied to each figure.</p>
</section>
<section id="analytics-demo" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="analytics-demo"><span class="header-section-number">3.3</span> Analytics Demo</h2>
<p>Students will work on a major project which will require a technical overview of an analysis of their choosing. None of the data used in this analysis can come from the student’s own research group. This will be presented in the last weeks of the course as a technical demonstration in class.</p>
<p>The goal of this project is to demonstrate a technical topic to an audience in an interesting way. Being able to communicate technical details in accessible ways is a critical skill for working with collaborators on scientific projects. People need to know what you did, what decisions were made and why, how they affected the outcome, and potential issues or shortcomings in the approach taken. While peer-review is one part of the scientific knowledge production process - increasingly it is not sufficient to just describe your methods in a paper, but these must be presented as supplementary code or a notebook which documents exact data processing steps.</p>
<p>Your task for the term project is to provide a complete analytic walk-through of an existing analysis from a paper in an area of interest (i.e., replicated by you but not from your research group). Please consult with me to confirm your chosen topic.</p>
<p>Useful data repositories include <a href="https://pangaea.de/" class="uri">https://pangaea.de/</a> , <a href="https://borealisdata.ca/" class="uri">https://borealisdata.ca/</a> , and <a href="https://portal.edirepository.org/" class="uri">https://portal.edirepository.org/</a> but many publishers will also host data with the peer-reviewed article.</p>
<ul>
<li><p>Demonstration: In this part of the project your goal is to articulate as clearly as possible to a scientific but non-specialized audience the full scope of your analysis. This should comprise about half of your written report and about 70% of your presentation/overview in class.</p></li>
<li><p>Critique: In this part of the project you should critically analyze the analysis and/or methods implemented in the package. Focus here on issues of data quality, uncertainty, key parameters, workflow, etc. Your aim here is to provide a critical overview of the methods and analysis presented so as to provide guidance and advice to scientific collaborators.</p></li>
<li><p>Submission: The term project here is comprised of a written report and an in-class demonstration. The report will be worth 65 points according to the following breakdown:</p></li>
<li><p>Technical depth ‒ /40</p></li>
<li><p>Critique ‒ /25</p></li>
<li><p>Accuracy ‒ /20</p></li>
<li><p>Writing style ‒ /15</p></li>
<li><p>The presentation will be worth 35 points and graded according to the following breakdown:</p></li>
<li><p>Aesthetic appeal ‒ /25</p></li>
<li><p>Clarity and communication style ‒ /25</p></li>
<li><p>Technical completeness ‒ /50</p></li>
</ul>
<p>The report should be no longer than 4000 words. The presentation should be between 13-15 minutes. The presentation file will not be submitted for grading.</p>
</section>
<section id="lecture-engagement" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="lecture-engagement"><span class="header-section-number">3.4</span> Lecture engagement</h2>
<p>Data analysis can often begin with cleaning and organizing data from other people or other research groups. The first engagement is to work through cleaning the raw palmerpanguins data to turn it into the cleaned penguins data used in the R for Data Science book. The goal is to give you exposure to several different tools and data issues in a controlled environment. Here is the raw data <a href="https://raw.githubusercontent.com/allisonhorst/palmerpenguins/master/inst/extdata/penguins_raw.csv">csv file</a>.</p>
<p>The second engagement is to work through importing, cleaning, and summarizing one spreadsheet of water isotope analyses. The goal is to give you exposure to the types of data you can receive from an analytical lab or a colleague and need to deal with. Here is the <a href="data/Water Isotopes 31-June-22.xlsx">xlsx file</a>.</p>
<p>You can use this <a href="GG606_template.Rmd">Rmd file</a> or this <a href="GG606_template.qmd">qmd file</a> as a template.</p>
<p>Your assignment should answer the following question(s) and be as reproducible as you can make it (i.e., I should be able to reproduce your answers). Do not include any external data files in your submission, only submit one .Rmd or .qmd file.</p>
<section id="questions-for-the-palmerpenguins" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="questions-for-the-palmerpenguins"><span class="header-section-number">3.4.1</span> Questions for the palmerpenguins:</h3>
<ul>
<li>Were you successful in cleaning the palmerpenguins raw data? Comment on three places where you would do something different. [5 marks]</li>
</ul>
</section>
<section id="questions-for-the-water-isotopes" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="questions-for-the-water-isotopes"><span class="header-section-number">3.4.2</span> Questions for the water isotopes:</h3>
<ul>
<li><p>Were you successful in importing and cleaning the data? Comment on two places where you were tripped up. [3 marks]</p></li>
<li><p>Summarize the data with a plot of δ<sup>18</sup>O-H<sub>2</sub>O (x axis) vs δ<sup>2</sup>H-H<sub>2</sub>O (y axis). Draw on the Global Meteoric Water Line (δ<sup>2</sup>H = 8.0 × δ<sup>18</sup>O + 10‰). This is the most common plot to begin visualizing these types of data. [2 marks]</p></li>
<li><p>See <a href="https://en.wikipedia.org/wiki/Global_meteoric_water_line" class="uri">https://en.wikipedia.org/wiki/Global_meteoric_water_line</a> for more details if you are curious about water isotopes.</p></li>
</ul>
</section>
</section>
<section id="participation" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="participation"><span class="header-section-number">3.5</span> Participation</h2>
<p>Students are expected to attend and participate in designated class times. Participation includes contributing to discussions, presenting small pieces of weekly homework, and working collaboratively with other students when needed.</p>
</section>
<section id="course-notebook" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="course-notebook"><span class="header-section-number">3.6</span> Course Notebook</h2>
<p>Students will keep a notebook to keep track of their learning throughout the course. These can be as digital or hardcopy, and will be graded at the end of the course for depth and quality of notes, and coverage of topics covered in the course. Hardcopy notebooks will be returned to students after grading. The goals of the notebook are to encourage some active participation and learning in the lecture part of the course and to encourage students to build their own take-aways that can be used later.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./readings.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Readings</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>